---
// Home page
import BaseLayout from '../layouts/BaseLayout.astro';

const pageTitle = "Home";

// Basic info
const name = "Yangliduo Lai";
const location = "Chongqing ¬∑ China";
const tagline = "Computer Science Student";

// Contact & social
const email = "yangliduolai@gmail.com";
const socialLinks = {
  email: `mailto:${email}`,
  github: "https://github.com/Yangliduo-Lai",
  linkedin: "https://www.linkedin.com",
  scholar: "https://scholar.google.com",
};

// Short self-introduction paragraphs
const aboutIntro = [
  "Hi there! üëã I'm Yangliduo Lai (ËµñÊù®‰∏ΩÂ§ö), a recent B.S. graduate from Southeast University (SEU). I'm currently pursuing my MPhil at UNSW under the supervision of Dr. Dong Wen and Dr. Zhengyi Yang.",
  "My research focuses on graph-based RAG memory and related topics.",
];

// Education history (reverse chronological order)
const education = [
  {
    period: "2026 ‚Äì Present",
    school: "The University of New South Wales",
    detail: "MPhil in Computer Science",
  },
  {
    period: "2021 ‚Äì 2025",
    school: "Southeast University",
    detail: "B.S. in Computer Science",
  },
];

// Simple featured publications on the home page
const publications = [
  //{
  //  year: "2025",
  //  title: "An Example Paper on Graph-based RAG Memory",
  //  venue: "To appear / under preparation",
  //},
];

// Load blog posts from src/pages/blogs/*.md
const modules = import.meta.glob('./blogs/*.md', { eager: true });

const posts = Object.entries(modules)
  .map(([path, mod]) => {
    const m = mod as any;
    const frontmatter = m.frontmatter ?? {};

    const title =
      frontmatter.title ??
      path.replace('./blogs/', '').replace('.md', '');

    const url = path.replace('./', '/').replace('.md', '/');

    const rawDate = frontmatter.pubDate;
    const dateObj = rawDate ? new Date(rawDate) : null;
    const ts =
      dateObj && !Number.isNaN(dateObj.getTime())
        ? dateObj.getTime()
        : 0;
    const dateText = dateObj
      ? dateObj.toLocaleDateString('en-US')
      : '';

    return { title, url, dateText, ts };
  })
  // Newest first (posts without a date go last)
  .sort((a, b) => b.ts - a.ts);

// Home page: show at most 10 blog posts
const latestPosts = posts.slice(0, 10);
---

<BaseLayout pageTitle={pageTitle}>
  <article class="home page-wrapper">
    <!-- Header: avatar + name + location + tagline + icons -->
    <header class="home-header">
      <div class="home-header-left">
        <div class="home-avatar">
          <img src={"src/assets/avatar.png"} alt={name} />
        </div>
        <div class="home-header-main">
          <h1 class="home-name">{name}</h1>
          <p class="home-location">{location}</p>
          <p class="home-tagline">{tagline}</p>

          <div class="home-social">
            <!-- EmailÔºöÊää src ÊîπÊàê‰Ω†ÁöÑÈÇÆÁÆ±ÂõæÊ†áË∑ØÂæÑ -->
            <a
              href={socialLinks.email}
              class="home-social-item"
              aria-label="Email"
            >
              <img
                src="src/assets/logos/gmail.png"
                alt="Email"
                class="home-social-icon"
              />
            </a>

            <!-- GitHubÔºöÊää src ÊîπÊàê‰Ω†ÁöÑ GitHub ÂõæÊ†áË∑ØÂæÑ -->
            <a
              href={socialLinks.github}
              class="home-social-item"
              aria-label="GitHub"
              target="_blank"
              rel="noopener noreferrer"
            >
              <img
                src="src/assets/logos/github.png"
                alt="GitHub"
                class="home-social-icon"
              />
            </a>

            <!-- LinkedInÔºöÊää src ÊîπÊàê‰Ω†ÁöÑ LinkedIn ÂõæÊ†áË∑ØÂæÑ -->
            <a
              href={socialLinks.linkedin}
              class="home-social-item"
              aria-label="LinkedIn"
              target="_blank"
              rel="noopener noreferrer"
            >
              <img
                src="src/assets/logos/linkin.png"
                alt="LinkedIn"
                class="home-social-icon"
              />
            </a>

            <!-- Google ScholarÔºöÊää src ÊîπÊàê‰Ω†ÁöÑ Scholar ÂõæÊ†áË∑ØÂæÑ -->
            <a
              href={socialLinks.scholar}
              class="home-social-item"
              aria-label="Google Scholar"
              target="_blank"
              rel="noopener noreferrer"
            >
              <img
                src="src/assets/logos/google_scholar.png"
                alt="Google Scholar"
                class="home-social-icon"
              />
            </a>
          </div>
        </div>
      </div>
    </header>

    <!-- About -->
    <section class="home-section">
      <h2 class="home-section-title">About</h2>
      {aboutIntro.map((para) => (
        <p>{para}</p>
      ))}

      <p class="home-cta-wrapper">
        <a href="/about" class="home-cta-link">More about me ‚Üí</a>
      </p>
    </section>

    <!-- Education -->
    <section class="home-section">
      <h2 class="home-section-title">Education</h2>
      <ul class="edu-list">
        {education.map((item) => (
          <li class="edu-item">
            <div class="edu-period">{item.period}</div>
            <div class="edu-main">
              <div class="edu-school">{item.school}</div>
              <div class="edu-detail">{item.detail}</div>
            </div>
          </li>
        ))}
      </ul>
    </section>

    <!-- Publications (summary) -->
    <section class="home-section">
      <h2 class="home-section-title">Publications</h2>
      {publications.length === 0 ? (
        <p>No publications listed yet.</p>
      ) : (
        <>
          <ul class="pub-list">
            {latestPublications.map((pub) => (
              <li class="pub-item">
                <span class="pub-year">{pub.year}</span>
                <div class="pub-main">
                  <div class="pub-title">{pub.title}</div>
                  {pub.venue && (
                    <div class="pub-venue">{pub.venue}</div>
                  )}
                </div>
              </li>
            ))}
          </ul>
        </>
      )}
    </section>

    <!-- Blog -->
    <section class="home-section">
      <h2 class="home-section-title">Blog</h2>
      {latestPosts.length === 0 ? (
        <p>No blog posts yet. I will write something soon üëÄ</p>
      ) : (
        <>
          <ul class="blog-list">
            {latestPosts.map((post) => (
              <li class="blog-item">
                {post.dateText && (
                  <span class="blog-date">{post.dateText}</span>
                )}
                <a href={post.url} class="blog-link">
                  {post.title}
                </a>
              </li>
            ))}
          </ul>
          <p class="home-cta-wrapper">
            <a href="/blog" class="home-cta-link">
              View all posts ‚Üí
            </a>
          </p>
        </>
      )}
    </section>
  </article>

  <style>
    .home {
      font-size: 0.95rem;
    }

    /* Header info */
    .home-header {
      margin-bottom: 1.5rem;
      display: flex;
      justify-content: flex-start;
      gap: 1.5rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .home-header-left {
      display: flex;
      align-items: center;
      gap: 1.2rem;
      flex: 1 1 auto;
      min-width: 0;
    }

    .home-avatar {
      width: 132px;   /* ÊîæÂ§ßÁöÑÂ§¥ÂÉè */
      height: 132px;
      border-radius: 999px;
      border: 2px solid #4c1d95;
      background-color: #f5f3ff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 1.1rem;
      color: #4c1d95;
      flex-shrink: 0;
      overflow: hidden;
    }

    .home-avatar img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
    }

    .home-header-main {
      min-width: 0;
    }

    .home-name {
      font-size: 1.9rem;
      margin: 0 0 0.25rem;
    }

    .home-location {
      margin: 0;
      color: #6b7280;
    }

    .home-tagline {
      margin: 0.25rem 0 0;
      color: #4b5563;
    }

    .home-social {
      margin-top: 0.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 1.3rem;
      align-items: center;
    }

    .home-social-item {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      padding: 0;
      border: none;
      background: none;
      cursor: pointer;
    }

    .home-social-icon {
      width: 24px;
      height: 24px;
      display: block;
      object-fit: contain;
      transition:
        transform 0.12s ease-out,
        filter 0.12s ease-out;
    }

    .home-social-item:hover .home-social-icon,
    .home-social-item:focus .home-social-icon {
      transform: translateY(-1px);
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.2));
    }

    /* Sections */
    .home-section {
      margin-top: 1.75rem;
    }

    .home-section-title {
      font-size: 1.2rem;
      margin: 0 0 0.75rem;
    }

    .home-section p {
      margin-top: 0;
      margin-bottom: 0.75rem;
    }

    /* Unified CTA link style */
    .home-cta-wrapper {
      margin-top: 0.5rem;
    }

    .home-cta-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.25rem 0.9rem;
      border-radius: 999px;
      border: 1px solid #c4b5fd;
      font-size: 0.9rem;
      text-decoration: none;
      color: #4c1d95;
      transition:
        background-color 0.15s ease,
        color 0.15s ease,
        border-color 0.15s ease;
    }

    .home-cta-link:hover,
    .home-cta-link:focus {
      background-color: #ede9fe;
      border-color: #a78bfa;
      color: #2e1065;
    }

    /* Publications summary */
    .pub-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .pub-item {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      padding: 0.25rem 0;
      align-items: baseline;
    }

    .pub-year {
      font-size: 0.85rem;
      color: #6b7280;
      min-width: 3rem;
    }

    .pub-main {
      flex: 1;
      min-width: 0;
    }

    .pub-title {
      font-size: 0.95rem;
      font-weight: 600;
    }

    .pub-venue {
      font-size: 0.85rem;
      color: #4b5563;
    }

    /* Education */
    .edu-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .edu-item {
      display: flex;
      gap: 0.75rem;
      padding: 0.4rem 0;
    }

    .edu-period {
      font-size: 0.85rem;
      color: #6b7280;
      min-width: 7.5rem;
    }

    .edu-school {
      font-weight: 600;
    }

    .edu-detail {
      font-size: 0.9rem;
      color: #4b5563;
    }

    /* Blog list */
    .blog-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .blog-item {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      padding: 0.25rem 0;
      align-items: baseline;
    }

    .blog-date {
      font-size: 0.85rem;
      color: #6b7280;
      min-width: 7.5rem;
    }

    .blog-link {
      text-decoration: none;
      color: #4c1d95;
      border-radius: 999px;
      padding: 0.1rem 0.3rem;
      transition:
        background-color 0.15s ease,
        color 0.15s ease;
    }

    .blog-link:hover,
    .blog-link:focus {
      background-color: #ede9fe;
      color: #2e1065;
    }

    @media (max-width: 640px) {
      .home-header {
        align-items: flex-start;
      }
    }

    /* Dark mode adjustments */
    html.dark .home-location {
      color: #9ca3af;
    }

    html.dark .home-tagline {
      color: #e5e7eb;
    }

    html.dark .home-avatar {
      border-color: #c4b5fd;
      background-color: #020617;
      color: #e9d5ff;
    }

    /* ÂõæÊ†áÊú¨Ë∫´ÊòØÂΩ©Ëâ≤ÂõæÁâáÔºåËøôÈáå‰∏çÂÜçÊîπÂèòËÉåÊôØÔºåÂè™‰øùÁïô hover ÊïàÊûú */
    html.dark .home-cta-link {
      border-color: #a78bfa;
      color: #e9d5ff;
    }

    html.dark .home-cta-link:hover,
    html.dark .home-cta-link:focus {
      background-color: rgba(168, 85, 247, 0.3);
      border-color: #c4b5fd;
      color: #f9fafb;
    }

    html.dark .edu-period {
      color: #9ca3af;
    }

    html.dark .edu-detail {
      color: #d1d5db;
    }

    html.dark .blog-date {
      color: #9ca3af;
    }

    html.dark .blog-link {
      color: #c4b5fd;
    }

    html.dark .blog-link:hover,
    html.dark .blog-link:focus {
      background-color: rgba(168, 85, 247, 0.22);
      color: #f9fafb;
    }

    html.dark .pub-year {
      color: #9ca3af;
    }

    html.dark .pub-venue {
      color: #d1d5db;
    }
  </style>
</BaseLayout>
